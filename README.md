# æˆ‘çš„nanoGPTå­¦ä¹ ç¬”è®°

## ðŸ“ nanoGPT å­¦ä¹ ç¬”è®°

æœ¬é¡¹ç›®æ˜¯æˆ‘çš„ nanoGPT å®žæˆ˜è®°å½•ã€‚
è¯¦ç»†çš„å­¦ä¹ å¿ƒå¾—ã€å®žéªŒå›¾è¡¨åŠæºç æ³¨é‡Šè¯·ç§»æ­¥ï¼š
[ðŸ‘‰ Study Notes åˆ†æ”¯](../../tree/study-notes)

### 1. æµ‹è¯•çŽ¯å¢ƒ (Test Environment)

åœ¨æ­£å¼å¼€å§‹æ¨¡åž‹è®­ç»ƒå‰ï¼Œæ˜Žç¡®ç¡¬ä»¶ä¸Žè½¯ä»¶çš„åŸºå‡†çº¿è‡³å…³é‡è¦ã€‚

* **ç¡¬ä»¶è®¾å¤‡ (Hardware):**
* **GPU:** NVIDIA GeForce RTX 4070 Ti Super (16GB VRAM) â€”â€” *æ³¨ï¼šè¿™æ˜¯ç›®å‰æ€§ä»·æ¯”æžé«˜çš„ 40 ç³»åˆ—æ˜¾å¡ï¼Œå…¶ 16GB å¤§æ˜¾å­˜å…è®¸æˆ‘ä»¬å°è¯•æ›´å¤§çš„ `batch_size`ã€‚*
* **CPU:** Intel i7-12700K


* **è½¯ä»¶çŽ¯å¢ƒ (Software):**
* **æ“ä½œç³»ç»Ÿ:** Windows 11
* **Python ç‰ˆæœ¬:** 3.12
* **æ ¸å¿ƒæ¡†æž¶:** PyTorch 2.5.1+cu121 (æˆ–å…¶ä»–ç‰ˆæœ¬ï¼Œå¯ç”¨ `pip show torch` æŸ¥çœ‹)


* **å…³é”®é…ç½®è¯´æ˜Ž (Configuration Notes):**
* **Device:** ä½¿ç”¨ `cuda` åŠ é€Ÿã€‚
* **Compile:** è®¾ä¸º `False`ã€‚*æŽ’é›·å¿ƒå¾—ï¼šåœ¨ Windows åŽŸç”ŸçŽ¯å¢ƒä¸‹ï¼Œç”±äºŽ Triton ç¼–è¯‘å™¨æš‚ä¸æ”¯æŒï¼Œå¼€å¯ `compile=True` ä¼šå¯¼è‡´æŠ¥é”™ï¼Œæ•…é‡‡ç”¨ Eager æ¨¡å¼è®­ç»ƒã€‚*
* **æ•°æ®é›†:** `shakespeare_char` (èŽŽå£«æ¯”äºšå­—ç¬¦çº§æ•°æ®é›†)ï¼Œæ€»è®¡çº¦ 111 ä¸‡ä¸ªå­—ç¬¦ã€‚

---

### 1.5 å®žéªŒç›‘æŽ§é…ç½® (Experiment Tracking)

ä¸ºäº†å®žçŽ°è®­ç»ƒè¿‡ç¨‹çš„å¯è§†åŒ–ç®¡ç†ï¼Œæˆ‘å¼•å…¥äº† **Weights & Biases (W&B)** å·¥å…·ã€‚ç›¸æ¯”äºŽæž¯ç‡¥çš„ç»ˆç«¯æ—¥å¿—ï¼Œå®ƒèƒ½æä¾›æ›´ç›´è§‚çš„ç›‘æŽ§ç»´åº¦ã€‚

* **è´¦å·ä¸Žç™»å½•**:
* **å¹³å°è´¦å·**: `zqc199304`ã€‚
* **æœ¬åœ°éªŒè¯**: é€šè¿‡æ‰§è¡Œ `wandb login` å‘½ä»¤ï¼Œå¹¶è¾“å…¥ä»Žå®˜ç½‘èŽ·å–çš„ API Key å®ŒæˆçŽ¯å¢ƒç»‘å®šã€‚
* **å­˜å‚¨ä½ç½®**: éªŒè¯æˆåŠŸåŽï¼Œå‡­è¯å°†è‡ªåŠ¨å­˜å‚¨åœ¨ `C:\Users\ZHU Qingchuan\_netrc` è·¯å¾„ä¸‹ï¼Œç¡®ä¿åŽç»­è®­ç»ƒèƒ½è‡ªåŠ¨åŒæ­¥æ•°æ®ã€‚


* **ç›‘æŽ§ä¼˜åŠ¿**:
* **å®žæ—¶ Loss æ›²çº¿**: èƒ½å¤Ÿå®žæ—¶è§‚å¯Ÿ `train/loss` å’Œ `val/loss` çš„èµ°å‘ï¼Œç›´è§‚åˆ¤æ–­æ¨¡åž‹æ˜¯å¦æ”¶æ•›æˆ–è¿‡æ‹Ÿåˆã€‚
* **ç¡¬ä»¶æ•ˆèƒ½è®°å½•**: è‡ªåŠ¨è®°å½• RTX 4070 Ti Super çš„ MFU (æ¨¡åž‹åˆ©ç”¨çŽ‡)ã€åŠŸçŽ‡ä»¥åŠæ¸©åº¦æ³¢åŠ¨ã€‚


### 2. æ•°æ®å‡†å¤‡ä¸Žç¼–ç åŽŸç† (Data Preparation)

åœ¨å¼€å§‹è®­ç»ƒä¹‹å‰ï¼Œå¿…é¡»è¿è¡Œ `data/shakespeare_char/prepare.py`ã€‚è¿™ä¸ªè¿‡ç¨‹åœ¨ `nanoGPT` ä¸­è¢«ç§°ä¸º **Tokenizationï¼ˆåˆ†è¯/åˆ†å·åŒ–ï¼‰**ã€‚

* **æ•°æ®æº**ï¼šä½¿ç”¨çš„æ˜¯èŽŽå£«æ¯”äºšå…¨é›†ã€‚è„šæœ¬é¦–å…ˆè¯»å–åŽŸå§‹çš„ `.txt` æ–‡æœ¬ï¼Œå¹¶è¯†åˆ«å‡ºæ–‡æœ¬ä¸­æ‰€æœ‰å‡ºçŽ°çš„å”¯ä¸€å­—ç¬¦ã€‚
* **è¯è¡¨ (Vocabulary)**ï¼šå¯¹äºŽè¿™ä¸ªç‰¹å®šçš„æ•°æ®é›†ï¼Œæ¨¡åž‹è¯†åˆ«å‡ºäº† **65 ä¸ªå”¯ä¸€å­—ç¬¦**ï¼ˆåŒ…æ‹¬å¤§å°å†™å­—æ¯ã€ç©ºæ ¼ã€æ¢è¡Œç¬¦å’Œæ ‡ç‚¹ï¼‰ã€‚
* ä¾‹å¦‚ï¼š`'\n'` å¯¹åº”ç¼–å· 0ï¼Œ`' '` å¯¹åº”ç¼–å· 1ï¼Œ`'!'` å¯¹åº”ç¼–å· 2ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚


* **ç¼–ç  (Encoding)**ï¼šè„šæœ¬å°†æ•´æœ¬åè‘—ä»Žâ€œå­—ç¬¦æµâ€è½¬æ¢ä¸ºâ€œæ•´æ•°æµâ€ã€‚
* **Train Set**: çº¦ 100 ä¸‡ä¸ª tokenã€‚
* **Val Set**: çº¦ 11 ä¸‡ä¸ª tokenã€‚


* **å­˜å‚¨æ ¼å¼**ï¼šç”Ÿæˆçš„ `.bin` æ–‡ä»¶æ˜¯ä»¥ `uint16` æ ¼å¼å­˜å‚¨çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¿™ç§æ ¼å¼èƒ½è®© PyTorch åœ¨è®­ç»ƒæ—¶ä»¥æžé«˜çš„æ•ˆçŽ‡ç›´æŽ¥å°†æ•°æ®åŠ è½½åˆ°å†…å­˜æˆ–æ˜¾å­˜ä¸­ï¼Œé¿å…äº†è¯»å–æ–‡æœ¬æ–‡ä»¶æ—¶çš„å­—ç¬¦è§£ç å¼€é”€ã€‚

---

#### æ ¸å¿ƒå‘çŽ°ï¼šæ¨¡åž‹åˆ°åº•åœ¨å­¦ä»€ä¹ˆï¼Ÿ

é€šè¿‡è§‚å¯Ÿ `prepare.py` çš„è¾“å‡ºï¼Œæˆ‘æ„è¯†åˆ°ï¼š

1. **GPT ä¸è¯†å­—**ï¼šæ¨¡åž‹çœ‹åˆ°çš„åªæ˜¯ `0, 18, 47, 64...` è¿™æ ·çš„æ•°å­—åºåˆ—ã€‚
2. **é¢„æµ‹ä»»åŠ¡**ï¼šè®­ç»ƒçš„æœ¬è´¨æ˜¯ç»™æ¨¡åž‹åºåˆ— `[1, 2, 3]`ï¼Œè®©å®ƒé¢„æµ‹ä¸‹ä¸€ä¸ªæ•°æ˜¯ `4` çš„æ¦‚çŽ‡ã€‚
3. **åŽ‹ç¼©çš„è‰ºæœ¯**ï¼šæˆ‘ä»¬å°† 111 ä¸‡ä¸ªå­—ç¬¦åŽ‹ç¼©æˆäº† 65 ä¸ªåŸºç¡€å•å…ƒçš„ç»„åˆã€‚

---

**ðŸ’¡ åŠ©æ•™ç‚¹è¯„ï¼š**
â€œå­—ç¬¦çº§ï¼ˆCharacter-levelï¼‰æ¨¡åž‹æ˜¯ç†è§£åŽŸç†çš„æœ€ä½³åˆ‡å…¥ç‚¹ã€‚è™½ç„¶åƒ GPT-4 è¿™æ ·çš„æ¨¡åž‹ä½¿ç”¨çš„æ˜¯æ›´å¤æ‚çš„ **BPE (Byte Pair Encoding)** åˆ†è¯æ–¹å¼ï¼ˆæŠŠå¸¸ç”¨çš„è¯æ ¹åˆ†åœ¨ä¸€èµ·ï¼‰ï¼Œä½†å…¶åº•å±‚é€»è¾‘ä¸Žä½ çŽ°åœ¨çœ‹åˆ°çš„è¿™ 65 ä¸ªå­—ç¬¦çš„æ˜ å°„æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ç†è§£äº†è¿™ 65 ä¸ªæ•°å­—ï¼Œä½ å°±ç†è§£äº† LLM çš„è¾“å…¥æœ¬è´¨ã€‚â€

åœ¨ nanoGPT çš„ shakespeare_char å®žéªŒä¸­ï¼Œè¯è¡¨ä»…ä¸º **65**ã€‚è¿™æ„å‘³ç€æ¨¡åž‹æ˜¯åœ¨â€œåƒç´ çº§â€åœ°å­¦ä¹ è¯­è¨€ã€‚å®ƒå¿…é¡»ä»Žå¤´å­¦ä¹ å¦‚ä½•æ‹¼å†™å•è¯ï¼Œå†å­¦ä¹ å¦‚ä½•ç»„åˆå¥å­ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¸»æµå¤§æ¨¡åž‹æ‹¥æœ‰**5 ä¸‡ç”šè‡³ 10 ä¸‡**ä»¥ä¸Šçš„è¯è¡¨ï¼Œå®ƒä»¬æ˜¯åœ¨â€œè¯æ±‡çº§â€è¿›è¡Œæ€è€ƒã€‚è™½ç„¶è¯è¡¨è§„æ¨¡ä¸åŒï¼Œä½†å…¶å°†æ–‡å­—è½¬åŒ–ä¸ºæ•°å­—ç´¢å¼•çš„åº•å±‚é€»è¾‘æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚

**è¯è¡¨ï¼ˆVocabularyï¼‰å¹¶éžæŒ‰ç±»åˆ«è®¡æ•°ï¼Œè€Œæ˜¯æŒ‰â€œå”¯ä¸€æ€§â€è®¡æ•°**ã€‚æ¯ä¸€ä¸ªç‹¬ç‰¹çš„å­—ç¬¦â€”â€”æ— è®ºæ˜¯å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—ï¼Œè¿˜æ˜¯æ¯ä¸€ä¸ªå…·ä½“çš„æ ‡ç‚¹ç¬¦å·ï¼ˆå¦‚ . , ! ç­‰ï¼‰â€”â€”éƒ½ä¼šåœ¨è¯è¡¨ä¸­å æ®ä¸€ä¸ªç‹¬ç«‹ä¸”å”¯ä¸€çš„ç´¢å¼•ä½ç½®ã€‚åœ¨ shakespeare_char æ•°æ®é›†ä¸­ï¼Œè¿™ 65 ä¸ªä½ç½®æ¶µç›–äº†æ‰€æœ‰å‡ºçŽ°åœ¨æ–‡é›†ä¸­çš„ç¬¦å·æ€»æ•°ã€‚

---


### 3. è®­ç»ƒå¯åŠ¨å‘½ä»¤

* **å®Œæ•´é›†æˆå¯åŠ¨æŒ‡ä»¤**:
ä¸ºäº†åŒæ—¶åˆ©ç”¨ GPU åŠ é€Ÿå¹¶å¼€å¯å¯è§†åŒ–ç›‘æŽ§ï¼Œå®Œæ•´çš„æ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼š
```bash
python train.py --dataset=shakespeare_char --device=cuda --compile=False --wandb_log=True --eval_interval=50 --eval_iters=20 --log_interval=10 --block_size=256 --batch_size=64 --n_layer=4 --n_head=4 --n_embd=256 --max_iters=2000
```

* `--wandb_log=True`: æ¿€æ´» W&B äº‘ç«¯åŒæ­¥ã€‚
* `--device=cuda`: æŒ‡å®šä½¿ç”¨ RTX 4070 Ti Super è¿›è¡Œè®¡ç®—ã€‚
* `--compile=False`: é¿å¼€ Windows çŽ¯å¢ƒä¸‹ Triton ç¼–è¯‘å™¨çš„å…¼å®¹æ€§é—®é¢˜ã€‚
* **`--eval_interval=50`**ï¼šè¿™æ˜¯å…³é”®ï¼åŽŸæœ¬æ¨¡åž‹å¯èƒ½æ¯ 500 æ­¥æ‰ç®—ä¸€æ¬¡éªŒè¯é›† Lossï¼ŒçŽ°åœ¨æ”¹ä¸ºæ¯ 50 æ­¥ç®—ä¸€æ¬¡ï¼Œè¿™æ ·ä½ åœ¨ WandB ä¸Šå°±èƒ½çœ‹åˆ°æ¯ 50 æ­¥ä¸€ä¸ªçš„éªŒè¯é›†æ•°æ®ç‚¹ï¼Œè¿žèµ·æ¥å°±æ˜¯ä¼˜ç¾Žçš„æ›²çº¿ã€‚
* **`--eval_iters=20`**ï¼šå› ä¸ºè¯„ä¼°å˜é¢‘ç¹äº†ï¼Œæˆ‘ä»¬å°†æ¯æ¬¡è¯„ä¼°æ—¶éšæœºæŠ½å–çš„æ ·æœ¬æ•°å‡å°åˆ° 20ï¼Œè¿™æ ·ä¸ä¼šæ‹–æ…¢æ•´ä½“è®­ç»ƒé€Ÿåº¦ã€‚


> * **é—®é¢˜è®°å½•**ï¼šåˆæ¬¡å®žéªŒç”±äºŽ `eval_interval` é»˜è®¤ä¸º 500ï¼Œå¯¼è‡´ WandB ä¸Šçš„ `val/loss` æ›²çº¿ä¿¡æ¯ç¼ºå¤±ã€‚
> * **è§£å†³ç­–ç•¥**ï¼šå°†è¯„ä¼°é—´éš”è°ƒæ•´ä¸ºæ¯ 50 æ¬¡è¿­ä»£ä¸€æ¬¡ï¼Œå¹¶ä¼˜åŒ–äº†åŒæ­¥å‚æ•°ã€‚
> * **æ”¶èŽ·**ï¼šèŽ·å¾—äº†è¿žç»­çš„ Loss ä¸‹é™æ›²çº¿ã€‚è§‚å¯Ÿå‘çŽ°ï¼ŒéªŒè¯é›†æŸå¤±åœ¨çº¦ 1200 æ­¥åŽå¼€å§‹è¶‹äºŽå¹³ç¼“ï¼Œè¿™ä¸ºåŽç»­è°ƒæ•´è®­ç»ƒæ—¶é•¿æä¾›äº†é‡åŒ–ä¾æ®ã€‚
> 

**ðŸ’¡ åŠ©æ•™ç‚¹è¯„ï¼š**
â€œè™½ç„¶ 4070 Ti Super æ€§èƒ½å¼ºåŠ²ï¼Œä½†å› ä¸º `nanoGPT` é»˜è®¤æ¨¡åž‹è¾ƒå°ï¼ˆ3.16M å‚æ•°ï¼‰ï¼Œæ­¤æ—¶æ˜¾å¡çš„ **MFU (æ¨¡åž‹åˆ©ç”¨çŽ‡)** ä»…åœ¨ 11% å·¦å³ã€‚è¿™æ„å‘³ç€æ˜¾å¡è¿˜æ²¡â€˜å‡ºæ±—â€™è®¡ç®—å°±ç»“æŸäº†ã€‚å¦‚æžœæœªæ¥å¢žåŠ  `n_layer` åˆ° 12 å±‚æˆ–å¢žåŠ  `n_embd` åˆ° 768ï¼Œæ˜¾å¡çš„æ½œåŠ›ä¼šå¾—åˆ°æ›´å¥½çš„é‡Šæ”¾ã€‚â€

---

### 4. å®žéªŒç»“æžœä¸Žå¯è§†åŒ–åˆ†æž (Results & Analysis)

#### **4.1 æœ€ç»ˆæ€§èƒ½æŒ‡æ ‡**

* **è®­ç»ƒæ­¥æ•°**: 2000 Iterations
* **Train Loss**: **0.9396** (æ¨¡åž‹å¯¹èŽŽå£«æ¯”äºšæ–‡æœ¬çš„æ‹Ÿåˆç¨‹åº¦æžé«˜)
* **Val Loss**: **1.7345** (éªŒè¯é›†è¡¨çŽ°ç¨³å®š)
* **ç¡¬ä»¶æ•ˆçŽ‡**: å¹³å‡ **400ms/iter**ï¼ŒMFU ç¨³å®šåœ¨ **10.2%** å·¦å³ã€‚ç”±äºŽ GPU æ€§èƒ½è¿œè¶…æ¨¡åž‹è®¡ç®—éœ€æ±‚ï¼Œæ˜¾å¡åœ¨è®­ç»ƒæœŸé—´æ¸©åº¦æžä½Žï¼Œæ•£çƒ­åŽ‹åŠ›å‡ ä¹Žä¸ºé›¶ã€‚

#### **4.2 WandB æ›²çº¿è§£è¯»**

é€šè¿‡å¯¹æ¯”ä¸¤æ¬¡å®žéªŒå¹¶åˆ é™¤å†—ä½™æ•°æ®ï¼Œçº¢çº¿æ¸…æ™°åœ°å±•ç¤ºäº†ä»¥ä¸‹è®­ç»ƒç‰¹å¾ï¼š
![Loss æ›²çº¿å›¾](assets/training_loss_curve.png)

* **æ”¶æ•›è¶‹åŠ¿**ï¼šLoss åœ¨å‰ 500 æ­¥å‘ˆçŽ°æŒ‡æ•°çº§ä¸‹é™ï¼ŒéšåŽæ–œçŽ‡æ”¾ç¼“ã€‚
* **è¿‡æ‹Ÿåˆè§‚å¯Ÿ**ï¼šæ³¨æ„åˆ° `val/loss` åœ¨çº¦ 1500 æ­¥ï¼ˆStep 30ï¼‰è¾¾åˆ°æžå°å€¼åŽæœ‰è½»å¾®çš„åå¼¹è¶‹åŠ¿ã€‚è¿™è¯´æ˜Ž 2000 æ­¥å¯¹äºŽå½“å‰æ¨¡åž‹è§„æ¨¡å·²ç»æ˜¯å­¦ä¹ çš„ä¸Šé™ï¼Œå†è®­ç»ƒä¸‹åŽ»æ¨¡åž‹å°±ä¼šå¼€å§‹â€œæ­»è®°ç¡¬èƒŒâ€è®­ç»ƒé›†ã€‚
* **ç­–ç•¥éªŒè¯**ï¼šå­¦ä¹ çŽ‡ï¼ˆLRï¼‰çš„çº¿æ€§é¢„çƒ­ï¼ˆWarmupï¼‰é˜¶æ®µåœ¨å›¾è¡¨ä¸­æ¸…æ™°å¯è§ï¼Œå®ƒæˆåŠŸå¼•å¯¼æ¨¡åž‹å¹³ç¨³åº¦è¿‡äº†åˆæœŸçš„ä¸ç¡®å®šæ€§ã€‚

---

### 5. æ¨¡åž‹é¦–ç§€ï¼šç”Ÿæˆç»“æžœå±•ç¤ºä¸Žè¯„ä»· (Model Inference)

ä½¿ç”¨è®­ç»ƒå¥½çš„æ£€æŸ¥ç‚¹ `ckpt.pt` è¿è¡Œ `sample.py`ï¼Œæ¨¡åž‹è¾“å‡ºäº†å…·æœ‰æµ“åŽšèŽŽå£«æ¯”äºšé£Žæ ¼çš„æ–‡æœ¬ã€‚
è¿è¡ŒæŽ¨ç†çš„ä»£ç æŒ‡ä»¤å¦‚ä¸‹ï¼š

```bash
python sample.py --out_dir=out --device=cuda
```

### ðŸ’¡ æŽ¨ç†ä»£ç å‚æ•°è¯¦è§£

* **`python sample.py`**ï¼šè°ƒç”¨é¡¹ç›®ä¸­çš„é‡‡æ ·è„šæœ¬ã€‚
* **`--out_dir=out`**ï¼šè¿™ä¸€æ­¥è‡³å…³é‡è¦ã€‚å®ƒå‘Šè¯‰è„šæœ¬åŽ» `out` æ–‡ä»¶å¤¹ä¸‹å¯»æ‰¾åä¸º `ckpt.pt` çš„æƒé‡æ–‡ä»¶ï¼ˆè¿™æ˜¯ä½ åˆšåˆšèŠ±è´¹ 15 åˆ†é’Ÿè®­ç»ƒå‡ºæ¥çš„â€œæ™ºæ…§ç»“æ™¶â€ï¼‰ã€‚
* **`--device=cuda`**ï¼šæŒ‡å®šä½¿ç”¨ä½ çš„ RTX 4070 Ti Super è¿›è¡Œç”Ÿæˆã€‚è™½ç„¶ CPU ä¹Ÿèƒ½è·‘æŽ¨ç†ï¼Œä½† GPU ä¼šè®©æ–‡å­—åƒæ³‰æ°´ä¸€æ ·çž¬é—´å–·æ¶Œè€Œå‡ºã€‚

è¿è¡Œ `python sample.py --out_dir=out --device=cuda` æ¿€æ´»äº†æ¨¡åž‹ã€‚è¯¥è„šæœ¬ä¼šè‡ªåŠ¨åŠ è½½è®­ç»ƒç”Ÿæˆçš„ `ckpt.pt` æ–‡ä»¶ï¼Œå¹¶åŸºäºŽ `data/shakespeare_char/meta.pkl` é‡Œçš„ 65 ä¸ªå­—ç¬¦è¯è¡¨ï¼Œå°†æ¨¡åž‹é¢„æµ‹çš„æ•°å­—é‡æ–°ç¿»è¯‘å›žäººç±»å¯è¯»çš„å­—ç¬¦ã€‚

#### **ç”Ÿæˆç‰‡æ®µç¤ºä¾‹ï¼š**

```text
And they brings father on, being it;

The searing shame is call'd from a thousands,

Which he that are from whence have an one heaven;

Much injury, he live to cae and either post,

As those bastard before his services like down,

And she careless the harms of tyranny and knowdpant,

To stop the secrets of one and who Clifford,

Still us Aufidius me with half my seeding in

Be resent or some many merry in hold,

To fight against thy country's defence:

The cares of loving and prayers on reproof.



KING EDW

---------------



Menenius, and go them as they are bear; and therefore

they will adde; and be husband with one.



FRIAR LAURENCE:

Repen up. Wide our knee woes.
```

è¿™æ®µç”Ÿæˆçš„æ–‡æœ¬æ˜¯æ¨¡åž‹é€šè¿‡ç»Ÿè®¡æ¦‚çŽ‡â€œæ‹¼å‡‘â€å‡ºæ¥çš„ã€‚è™½ç„¶å®ƒå®Œç¾Žæ¨¡ä»¿äº†èŽŽå£«æ¯”äºšçš„è¯­æ°”å’Œç”¨è¯ï¼Œä½†ç”±äºŽé€»è¾‘é“¾æ¡æ–­è£‚ï¼Œå¾ˆå¤šå¥å­åœ¨è¯­æ³•ä¸Šæ˜¯ç ´ç¢Žçš„ï¼Œç”šè‡³å«æœ‰ç”Ÿé€ è¯ï¼ˆå¦‚ `knowdpant`ï¼‰ã€‚

ä»¥ä¸‹æ˜¯å¯¹è¿™æ®µé‡‡æ ·ç»“æžœçš„æ„è¯‘ï¼Œæˆ‘å°è¯•åœ¨ä¿æŒé‚£ç§â€œèˆžå°æˆå‰§æ„Ÿâ€çš„åŒæ—¶ï¼Œè®©ç ´ç¢Žçš„é€»è¾‘æ˜¾å¾—è‡ªç„¶ä¸€äº›ï¼š

**æ–‡æœ¬æ„è¯‘ï¼ˆèŽŽå£«æ¯”äºšé£Žæ ¼ï¼‰**

```bash

ä»–ä»¬å¸¦ç€çˆ¶äº²èµ°ä¸Šå‰æ¥ï¼Œæ­£å› å¦‚æ­¤ï¼›
é‚£ç¼äººçš„ç¾žè¾±è¢«åƒä¸‡äººä¼ å”¤ï¼Œ
ä»–ï¼Œä»Žé‚£å”¯ä¸€çš„ä¸Šå¤©ä¹‹å¤„è€Œæ¥ï¼›
èº«è´Ÿé‡ä¼¤ï¼Œä»–æ´»åœ¨å è½ä¸Žé‚®é©¿ä¹‹é—´ï¼Œ
æ­£å¦‚é‚£äº›æ‚ç§ï¼Œåœ¨ä¾›èŒå‰ä¾¿å·²å€’ä¸‹ï¼Œ
å¥¹å¯¹æš´æ”¿çš„ä¼¤å®³ä¸Ž**æƒŠæ**ï¼ˆç”Ÿé€ è¯æ„è¯‘ï¼‰æ¼«ä¸ç»å¿ƒï¼Œ
ä¸ºäº†æŽ©ç›–é‚£å”¯ä¸€çš„ç§˜å¯†ï¼Œè¿˜æœ‰é‚£å…‹åˆ©ç¦å¾·ï¼Œ
å¥¥è²è¿ªä¹Œæ–¯ä¾ç„¶ç”¨æˆ‘ä¸€åŠçš„ç²¾å…ƒä¸Žæˆ‘åŒåœ¨ï¼Œ
æˆ–æ˜¯å¿ƒæ€€æ€¨æ¨ï¼Œæˆ–æ˜¯æ¬¢æ¬£åœ°ç´§æ¡ï¼Œ
åŽ»ä¸ºæŠµå¾¡ä½ çš„ç¥–å›½è€Œæˆ˜ï¼š
æ…ˆçˆ±ä¹‹å¿§è™‘ä¸Žè´£å¤‡ä¹‹ç¥ˆç¥·ã€‚

çˆ±å¾·åŽå›½çŽ‹ï¼š

æ¢…å†…å°¼åŽ„æ–¯ï¼ŒåŽ»è·Ÿç€ä»–ä»¬ï¼Œå°±åƒä»–ä»¬åŽŸæœ¬çš„æ ·å­ï¼›
å› æ­¤ä»–ä»¬ä¼šå˜æœ¬åŠ åŽ‰ï¼›å¹¶ä¸Žä¸€äººç»“ä¸ºè¿žç†ã€‚

åŠ³ä¼¦æ–¯ç¥žçˆ¶ï¼š
æ‚”æ‚Ÿå§ã€‚æ‰©å¼€æˆ‘ä»¬è†ä¸‹çš„æ‚²å“€ã€‚
---
```
**ä¸ºä»€ä¹ˆç¿»è¯‘èµ·æ¥æ„Ÿè§‰â€œæ€ªæ€ªçš„â€ï¼Ÿ**

ä½ åœ¨é˜…è¯»ç¿»è¯‘æ—¶æ„Ÿåˆ°çš„ä¸é€šé¡ºï¼Œæ°æ°åæ˜ äº†æ¨¡åž‹åœ¨è®­ç»ƒåŽçš„çœŸå®žçŠ¶æ€ã€‚æˆ‘ä»¬å¯ä»¥ä»Žä»¥ä¸‹ä¸‰ä¸ªå±‚é¢è§£æžè¿™äº›å¯¹è¯ï¼š

* **è¯æ³•å±‚é¢ï¼ˆå•è¯æ­£ç¡®ï¼‰**ï¼šæ¨¡åž‹å·²ç»èƒ½æ‹¼å†™å‡º `thousands`, `tyranny`, `defence` ç­‰é«˜é˜¶è¯æ±‡ï¼Œè¿™è¯´æ˜Žå®ƒå·²ç»æŽŒæ¡äº†å­—æ¯ç»„åˆçš„æ¦‚çŽ‡ã€‚
* **å¥æ³•å±‚é¢ï¼ˆé€»è¾‘æ–­è£‚ï¼‰**ï¼šå¥å­ä¹‹é—´ç¼ºä¹é€»è¾‘è¿žæŽ¥ã€‚ä¾‹å¦‚ `And they brings father on, being it;` åœ¨è¯­æ³•ä¸Šæ˜¯æžå…¶ç”Ÿç¡¬çš„ã€‚è¿™æ˜¯å› ä¸ºæ¨¡åž‹çš„ `block_size`ï¼ˆæ³¨æ„åŠ›çª—å£ï¼‰è¾ƒå°ï¼Œä¸” 316M çš„å‚æ•°é‡ä¸è¶³ä»¥è®©å®ƒç†è§£æ·±å±‚çš„å› æžœå…³ç³»ã€‚
* **è¯­å¢ƒå¤§ä¹±æ–—**ï¼šè¿™æ®µè¯é‡ŒåŒæ—¶å‡ºçŽ°äº†ã€Šäº¨åˆ©å…­ä¸–ã€‹çš„ Cliffordã€ã€Šç§‘é‡Œå¥¥å…°çº³æ–¯ã€‹çš„ Aufidius å’Œ Meneniusï¼Œä»¥åŠã€Šç½—å¯†æ¬§ä¸Žæœ±ä¸½å¶ã€‹çš„ Friar Laurenceã€‚æ¨¡åž‹å¹¶æ²¡æœ‰åœ¨â€œå†™å‰§æœ¬â€ï¼Œå®ƒåªæ˜¯åœ¨â€œèŽŽå£«æ¯”äºšé£Žæ ¼â€çš„æ¦‚çŽ‡æµ·æ´‹é‡Œéšæœºåž‚é’“ã€‚


> **é‡‡æ ·ç»“æžœç¿»è¯‘å¿ƒå¾—ï¼š**
> ç¿»è¯‘è¿‡ç¨‹ä¸­å‘çŽ°ï¼Œæ¨¡åž‹è™½ç„¶æŽŒæ¡äº†â€œå½¢â€ï¼ˆå¦‚å¤è‹±è¯­ä»£è¯ã€æˆå‰§åŒ–åè¯ï¼‰ï¼Œä½†å°šæœªé¢†æ‚Ÿâ€œæ„â€ï¼ˆé•¿ç¨‹é€»è¾‘ï¼‰ã€‚é‡‡æ ·æ–‡æœ¬è¡¨çŽ°å‡ºæžå¼ºçš„**å±€éƒ¨è¿žè´¯æ€§**å’Œ**å…¨å±€è’è°¬æ€§**ã€‚è¿™è¯´æ˜Žæ¨¡åž‹ç›®å‰åªæ˜¯ä¸€ä¸ªæžä½³çš„â€œé£Žæ ¼å¤å°æœºâ€ï¼Œè€ŒéžçœŸæ­£çš„â€œå‰§ä½œå®¶â€ã€‚

#### **æ·±åº¦è§£æžï¼šæ¨¡åž‹å­¦ä¼šäº†ä»€ä¹ˆï¼Ÿ**

çœ‹åˆ°è¿™äº›è¾“å‡ºï¼Œä½ å®žé™…ä¸Šæ­£åœ¨è§è¯ä¸€ä¸ª**316ä¸‡å‚æ•°çš„â€œæ•°å­—è„‘â€å¦‚ä½•ä»Žéšæœºè§„å¾‹ä¸­é‡æž„æ–‡å­¦é£Žæ ¼**ã€‚è¿™äº›å¯¹è¯ä¹‹æ‰€ä»¥é•¿æˆè¿™æ ·ï¼Œæ˜¯ç”± GPT æž¶æž„çš„æœ¬è´¨å’Œå­—ç¬¦çº§ï¼ˆCharacter-levelï¼‰è®­ç»ƒçš„ç‰¹ç‚¹å†³å®šçš„ã€‚

**1. æ ¼å¼ä¸Šçš„â€œç²¾å‡†æ¨¡ä»¿â€**

æ¨¡åž‹å·²ç»å®Œç¾Žå­¦ä¼šäº†èŽŽå£«æ¯”äºšå‰§æœ¬çš„**è§†è§‰æŽ’ç‰ˆè§„å¾‹**ã€‚

* **è§’è‰²æ ‡è¯†**ï¼šå®ƒçŸ¥é“æ¯ä¸€ä¸ªå¯¹è¯å—ï¼ˆChunkï¼‰é€šå¸¸ä»¥å¤§å†™å­—æ¯çš„è§’è‰²åå¼€å¤´ï¼ˆå¦‚ `FRIAR LAURENCE:`, `ROMEO:`, `AUFIDIUS:`ï¼‰ï¼Œä¸”åå­—åŽé¢ç´§è·Ÿå†’å·ã€‚
* **å°è¯ç»“æž„**ï¼šå®ƒå­¦ä¼šäº†å°è¯çš„æ¢è¡Œé€»è¾‘ï¼Œä½¿å…¶çœ‹èµ·æ¥åƒè¯—å‰§ï¼ˆiambic pentameterï¼‰çš„èŠ‚å¥ã€‚
* **åˆ†éš”ç¬¦**ï¼šç”Ÿæˆç»“æžœä¸­å‡ºçŽ°çš„ `---------------` æ˜¯å®ƒåœ¨æ¨¡ä»¿æ•°æ®é›†ä¸­ä¸åŒå‰§æœ¬æˆ–ç« èŠ‚ä¹‹é—´çš„ç‰©ç†åˆ†éš”ç¬¦ã€‚

**2. å†…å®¹ä¸Šçš„â€œè¯­ä¹‰å¹»è§‰â€ (Hallucination)**

ä½ å¯èƒ½ä¼šå‘çŽ°è¿™äº›å¯¹è¯â€œè¯»èµ·æ¥å¾ˆæœ‰æ„Ÿè§‰ï¼Œä½†é€»è¾‘ä¸é€šâ€ï¼Œè¿™æ˜¯ç”±äºŽä»¥ä¸‹åŽŸå› ï¼š

* **å­—ç¬¦çº§é¢„æµ‹çš„å±€é™**ï¼šæ¨¡åž‹æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦â€œçŒœâ€å‡ºæ¥çš„ï¼ˆæ¯”å¦‚çŒœåˆ° `R`ï¼ŒåŽé¢æ¦‚çŽ‡æœ€å¤§çš„æ˜¯ `O`, ç„¶åŽæ˜¯ `M`...ï¼‰ã€‚å®ƒçŽ°åœ¨å¤„äºŽèƒ½æ‹¼å¯¹å•è¯ï¼ˆå¦‚ `heaven`, `country`, `victory`ï¼‰ï¼Œä½†æ— æ³•ç†è§£æ•´å¥é•¿é€»è¾‘çš„é˜¶æ®µã€‚
* **è·¨æ—¶ç©ºå¤§ä¹±æ–—**ï¼šä½ ä¼šçœ‹åˆ°ã€Šç½—å¯†æ¬§ä¸Žæœ±ä¸½å¶ã€‹é‡Œçš„ `ROMEO` åœ¨å’Œã€Šç§‘é‡Œå¥¥å…°çº³æ–¯ã€‹é‡Œçš„ `AUFIDIUS` è¯´è¯ã€‚è¿™æ˜¯å› ä¸ºåœ¨è®­ç»ƒæ—¶ï¼Œæ‰€æœ‰çš„å‰§æœ¬éƒ½è¢«å–‚ç»™äº†æ¨¡åž‹ï¼Œæ¨¡åž‹æŠŠå®ƒä»¬æ··æˆäº†ä¸€ä¸ªå·¨å¤§çš„â€œèŽŽå£«æ¯”äºšå®‡å®™â€ã€‚
* **å•è¯åˆ›é€ **ï¼šæ¨¡åž‹å¶å°”ä¼šç”Ÿé€ ä¸€äº›è¯ï¼Œæ¯”å¦‚ `knowdpant` æˆ– `wrioDu'd`ã€‚è¿™è¯´æ˜Ž 0.94 çš„ Loss è™½ç„¶å¾ˆä½Žï¼Œä½†è¿˜æ²¡ä½Žåˆ°èƒ½å®Œå…¨è§„é¿æ‹¼å†™é”™è¯¯ï¼Œå®ƒåœ¨å°è¯•ç»“åˆä¸¤ä¸ªå•è¯çš„æ¦‚çŽ‡æ—¶â€œæ‰‹æ»‘â€äº†ã€‚

**3. è¯­è¨€é£Žæ ¼çš„â€œé™ç»´æ‰“å‡»â€**

å³ä¾¿é€»è¾‘æ··ä¹±ï¼Œæ¨¡åž‹å´æ•æ‰åˆ°äº†æžå…¶åœ°é“çš„**è¯é¢‘ç‰¹å¾**ï¼š

* **ä»£è¯ä¹ æƒ¯**ï¼šå¤§é‡ä½¿ç”¨ `thou`, `thee`, `thy`ã€‚
* **åŠ¨è¯å˜ä½“**ï¼šä½¿ç”¨äº† `hath`, `seal'st`, `doth`ã€‚
* **æˆå‰§åŒ–è¯æ±‡**ï¼šé«˜é¢‘å‡ºçŽ° `shame`, `tyranny`, `heaven`, `death`, `blood`ã€‚
* **è¯„ä»·**ï¼šè¿™è¯´æ˜Žæ¨¡åž‹æˆåŠŸæ•æ‰åˆ°äº†èŽŽå£«æ¯”äºšæ–‡å­—ä¸­çš„â€œæƒ…ç»ªåº•è‰²â€å’Œâ€œç”¨è¯æ¦‚çŽ‡â€ã€‚

> **å¯¹è¯ç”Ÿæˆé€»è¾‘åˆ†æžï¼š**
> é‡‡æ ·ç»“æžœæ˜¾ç¤ºæ¨¡åž‹å·²ä»Žâ€œéšæœºå­—ç¬¦â€è¿›åŒ–åˆ°äº†â€œé£Žæ ¼æ¨¡ä»¿â€é˜¶æ®µã€‚
> * **å±€éƒ¨è¿žè´¯æ€§**ï¼šåœ¨å•è¯å’ŒçŸ­è¯­å±‚é¢ï¼ˆå¦‚ `The searing shame is call'd from a thousands`ï¼‰ï¼Œæ¨¡åž‹è¡¨çŽ°å‡ºäº†æƒŠäººçš„é¢„æµ‹å‡†ç¡®åº¦ã€‚
> * **å…¨å±€é€»è¾‘ç¼ºå¤±**ï¼šç”±äºŽ `block_size` ä»…ä¸º 256ï¼Œä¸”å‚æ•°é‡è¾ƒå°ï¼Œæ¨¡åž‹æ— æ³•ç»´æŒé•¿ç¨‹çš„å‰§æƒ…é€»è¾‘ï¼Œå¯¼è‡´è§’è‰²æ··æ·†å’Œè¯­æ„ç¢Žç‰‡åŒ–ã€‚
> * **ç»“è®º**ï¼šè¿™è¯æ˜Žäº† GPT çš„æ ¸å¿ƒèƒ½åŠ›â€”â€”**ç»Ÿè®¡è¯­è¨€å»ºæ¨¡**ã€‚å®ƒå¹¶ä¸ç†è§£ä»€ä¹ˆæ˜¯â€œæ­»äº¡â€æˆ–â€œçˆ±æƒ…â€ï¼Œå®ƒåªæ˜¯è®¡ç®—å‡ºäº†åœ¨ `ROMEO:` ä¹‹åŽï¼Œå‡ºçŽ° `Some stiles` è¿™ç±»è¯æ±‡çš„æ•°å­¦æ¦‚çŽ‡æœ€é«˜ã€‚
> 
> 
---
